# 図書館管理システム(CLI) 仕様書

## 1. 概要

このシステムは、Pythonを用いて構築されたコンソールベースの図書館管理ツールです。管理者は本の登録・検索・削除・更新を行い、ユーザーは名前を登録して本の貸出・返却・履歴確認ができます。データはJSONファイルに保存され、永続的に管理されます。


## 2. 使用技術

| 項目         | 内容                          |
|--------------|-------------------------------|
| 言語         | Python 3.x                    |
| データ保存   | JSONファイル（books.json, users.json） |
| 実行形式     | コンソールアプリケーション     |
| 外部ライブラリ | なし（標準ライブラリのみ）     |


## 3. ファイル構成

```
library_system/
├── library.py               # メインプログラム
├── books.json               # 本のデータ（自動生成）
└── users.json               # ユーザーと貸出履歴（自動生成）
```



## 4. データ構造

### 4.1 本のデータ（books.json）

```json
{
  "タイトル": {
    "author": "著者名",
    "available": true
  }
}
```

- `available`: `true` → 貸出可能、`false` → 貸出中

### 4.2 ユーザーデータ（users.json）

```json
{
  "ユーザー名": {
    "borrowed": ["タイトル1", "タイトル2"]
  }
}
```

- `borrowed`: 現在借りている本のタイトル一覧（最大3冊）



## 5. 機能一覧

### 5.1 管理者機能

| 機能名       | 説明                                                                 |
|--------------|----------------------------------------------------------------------|
| 本の追加     | タイトルと著者名を入力して図書館に本を登録。重複チェックあり。         |
| 本の検索     | キーワードでタイトルを部分一致検索し、著者名と貸出状況を表示。           |
| 本の削除     | タイトルを指定して本を削除。存在しない場合はエラーメッセージ。           |
| 本の更新     | タイトルを指定して著者名を変更。存在しない場合はエラーメッセージ。       |

### 5.2 ユーザー機能

| 機能名       | 説明                                                                 |
|--------------|----------------------------------------------------------------------|
| ユーザー登録 | 初回アクセス時にユーザー名を登録。既存ユーザーは履歴を引き継ぐ。         |
| 本の貸出     | 貸出可能な本を選択して借りる。1人最大3冊まで。                         |
| 本の返却     | 借りている本を選択して返却。                                          |
| 履歴確認     | 現在借りている本の一覧を表示。                                        |



## 6. 関数仕様

### 6.1 共通処理

| 関数名         | 説明                                      |
|----------------|-------------------------------------------|
| `load_data(file)` | JSONファイルを読み込み、辞書として返す。ファイルがなければ空の辞書を返す。 |
| `save_data(file, data)` | 辞書データをJSONファイルに保存する。 |

### 6.2 管理者処理

| 関数名         | 説明                                      |
|----------------|-------------------------------------------|
| `add_book(books)` | 本を追加。タイトル重複チェックあり。         |
| `search_books(books)` | キーワードで本を検索し、著者と貸出状況を表示。 |
| `delete_book(books)` | 本を削除。存在しない場合はエラー表示。       |
| `update_book(books)` | 著者名を更新。存在しない場合はエラー表示。   |

### 6.3 ユーザー処理

| 関数名         | 説明                                      |
|----------------|-------------------------------------------|
| `borrow_book(books, users, username)` | 本を借りる。貸出可能かつ3冊未満であることを確認。 |
| `return_book(books, users, username)` | 本を返却。借りている本であることを確認。           |



## 7. 操作フロー

```text
起動
 └─> メインメニュー表示
      ├─> 管理者モード
      │    ├─> 本の追加・検索・削除・更新
      │    └─> books.json に保存
      ├─> ユーザーモード
      │    ├─> ユーザー名入力（新規登録可）
      │    ├─> 本の貸出・返却・履歴確認
      │    └─> books.json, users.json に保存
      └─> 終了
```



## 8. 入力制約とエラーハンドリング

- 本のタイトルは一意である必要がある。
- ユーザーは最大3冊まで借りられる。
- 存在しない本や借りていない本を返却しようとすると警告を表示。
- メニュー選択は1〜5の範囲でチェック。



## 9. 今後の発展

| 機能名         | 説明                                      |
|----------------|-------------------------------------------|
| Web化          | FlaskなどでWebアプリとして公開。               |
| データベース化          | MySQLを使ったデータ管理               |

